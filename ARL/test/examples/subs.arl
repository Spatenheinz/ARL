fun subsequences [] = [[]]
    | (x :: xs) = let ss0 = subsequences xs in
                  let ss1 = consAll (x :: ss0) in
                  ss1

fun consAll (x, (s :: [])) = (s :: x :: s)
    |       (x, (s :: ss)) = let ss1 = consAll (x,ss) in
                             (s :: (x :: s) :: ss1)


fun main =
    subsequences
